parameters:
  profile: rhel8unreg
  network: default
  default_domain: nontoonyt.lan
  controller_cpus: 2
  controller_ram: 8192
  hub_cpus: 1
  hub_ram: 8192
  db_cpus: 1
  db_ram: 4096
  lb_cpus: 1
  lb_ram: 2048
  installer_inventory: full_installer_inventory.j2
  all_groups:
    controllers:
      - controller1
      - controller2
      - controller3
    hub:
      - aaphub
    lb:
      - aap
    db:
      - aapdb
  all_vms:
    - controller1
    - controller2
    - controller3
    - aap
    - aaphub
    - aapdb
  ctrl_lb_groups:
    controllers:
      - controller1
      - controller2
      - controller3
    lb:
      - aap
  ctrl_lb_vms:
    - controller1
    - controller2
    - controller3
    - aap

tower_internal:
  type: network
  cidr: 10.0.10.0/24
  nat: False
default:
  type: network
  cidr: 192.168.122.0/24
  domain: {{ default_domain }}
controller1:
  memory: {{ controller_ram }}
  numcpus: {{ controller_cpus }}
  nets:
    - {{ network }}
    - tower_internal
  pool: first
  profile: {{ profile }}
  cmdline: ipv6.disable=1
controller2:
  memory: {{ controller_ram }}
  numcpus: {{ controller_cpus }}
  nets:
    - {{ network }}
    - tower_internal
  pool: first
  profile: {{ profile }}
controller3:
  memory: {{ controller_ram }}
  numcpus: {{ controller_cpus }}
  nets:
    - {{ network }}
    - tower_internal
  pool: first
  profile: {{ profile }}
aapdb:
  memory: {{ db_ram }}
  numcpus: {{ db_cpus }}
  nets:
    - {{ network }}
  pool: ssd
  profile: {{ profile }}
aaphub:
  memory: {{ hub_ram }}
  numcpus: {{ hub_cpus }}
  nets:
    - {{ network }}
  pool: second
  profile: {{ profile }}
aap:
  memory: {{ lb_ram }}
  numcpus: {{ lb_cpus }}
  nets:
    - {{ network }}
  pool: second
  profile: {{ profile }}
00_check:
  type: ansible
  playbook: 00_check.yml
  groups: {{ all_groups }}
  vms: {{ all_vms }}
01_prep:
  type: ansible
  playbook: 01_prep.yml
  groups: {{ all_groups }}
  vms: {{ all_vms }}
  variables:
    skip_utilities: {{ skip_utilities | default('false') }}
    skip_updates: {{ skip_updates | default('false') }}
    timezone: {{ timezone | default('Europe/Amsterdam') }}
02_install:
  type: ansible
  playbook: 02_install.yml
  groups: {{ all_groups }}
  vms: {{ all_vms }}
  variables:
    installer_inventory: {{ installer_inventory }}
    controller_over_http: {{ controller_over_http | default('true') }}
03_post:
  type: ansible
  playbook: 03_post.yml
  groups: {{ ctrl_lb_groups }}
  vms: {{ ctrl_lb_vms }}
04_lb:
  type: ansible
  playbook: 04_lb.yml
  groups: {{ ctrl_lb_groups }}
  vms: {{ ctrl_lb_vms }}
  variables:
    controller_over_http: {{ controller_over_http | default('true') }}
05_config:
  type: ansible
  playbook: 05_config.yml
  groups: {{ ctrl_lb_groups }}
  vms: {{ ctrl_lb_vms }}
